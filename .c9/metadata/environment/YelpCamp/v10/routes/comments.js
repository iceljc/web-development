{"filter":false,"title":"comments.js","tooltip":"/YelpCamp/v10/routes/comments.js","undoManager":{"mark":15,"position":15,"stack":[[{"start":{"row":44,"column":0},"end":{"row":51,"column":0},"action":"remove","lines":["//middleware","function isLoggedIn(req, res, next){","    if(req.isAuthenticated()){","        return next();","    }","    res.redirect(\"/login\");","}",""],"id":2}],[{"start":{"row":3,"column":43},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":3}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":42},"action":"insert","lines":["var middleware = require(\"../middleware\");"],"id":4}],[{"start":{"row":7,"column":19},"end":{"row":7,"column":30},"action":"insert","lines":["middleware."],"id":5}],[{"start":{"row":20,"column":16},"end":{"row":20,"column":17},"action":"insert","lines":[" "],"id":6}],[{"start":{"row":20,"column":17},"end":{"row":20,"column":28},"action":"insert","lines":["middleware."],"id":7}],[{"start":{"row":20,"column":39},"end":{"row":20,"column":40},"action":"insert","lines":[" "],"id":8}],[{"start":{"row":45,"column":0},"end":{"row":46,"column":0},"action":"insert","lines":["",""],"id":9},{"start":{"row":46,"column":0},"end":{"row":47,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":45,"column":0},"end":{"row":54,"column":3},"action":"insert","lines":["// COMMENT EDIT ROUTE","router.get(\"/:comment_id/edit\", middleware.checkCommentOwnership, function(req, res){","   Comment.findById(req.params.comment_id, function(err, foundComment){","      if(err){","          res.redirect(\"back\");","      } else {","        res.render(\"comments/edit\", {campground_id: req.params.id, comment: foundComment});","      }","   });","});"],"id":10}],[{"start":{"row":44,"column":0},"end":{"row":45,"column":0},"action":"insert","lines":["",""],"id":11}],[{"start":{"row":56,"column":0},"end":{"row":57,"column":0},"action":"insert","lines":["",""],"id":12}],[{"start":{"row":57,"column":0},"end":{"row":66,"column":3},"action":"insert","lines":["// COMMENT UPDATE","router.put(\"/:comment_id\", middleware.checkCommentOwnership, function(req, res){","   Comment.findByIdAndUpdate(req.params.comment_id, req.body.comment, function(err, updatedComment){","      if(err){","          res.redirect(\"back\");","      } else {","          res.redirect(\"/campgrounds/\" + req.params.id );","      }","   });","});"],"id":13}],[{"start":{"row":66,"column":3},"end":{"row":67,"column":0},"action":"insert","lines":["",""],"id":14},{"start":{"row":67,"column":0},"end":{"row":68,"column":0},"action":"insert","lines":["",""]}],[{"start":{"row":68,"column":0},"end":{"row":78,"column":3},"action":"insert","lines":["// COMMENT DESTROY ROUTE","router.delete(\"/:comment_id\", middleware.checkCommentOwnership, function(req, res){","    //findByIdAndRemove","    Comment.findByIdAndRemove(req.params.comment_id, function(err){","       if(err){","           res.redirect(\"back\");","       } else {","           res.redirect(\"/campgrounds/\" + req.params.id);","       }","    });","});"],"id":15}],[{"start":{"row":4,"column":42},"end":{"row":4,"column":43},"action":"insert","lines":[" "],"id":16}],[{"start":{"row":4,"column":43},"end":{"row":4,"column":89},"action":"insert","lines":["// automatically import index file in that dir"],"id":17}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":4,"column":89},"end":{"row":4,"column":89},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1558154121984,"hash":"40ff74d9cdb12b4f550c67c9893dfb22e458a354"}